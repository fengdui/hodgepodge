# 防重复提交
## 我认为可以分为3种情况 用户短时间重复点击 用户隔了一段时间后重复提交 系统重试 如果前端做按钮置空 那第一种情况可以忽视了
* 方案1 每次请求带token token存到redis token可能一样或者不一样
  * 一样是同一次请求系统中间件网关重试了 这种直接拦截
  * 不一样是用户真实操作了多次 如果前端已经做了按钮置空 那用户是隔了一段时间重复请求 因为隔的时间已经够长了 是用户真实需要请求
  * 如果前端没做按钮置空 那后端也是需要拦截的 做法是一样的
* 方案2 对参数进行md5存到redis
  * 其实md5的信息作业和token一样了 但是md5一样不能区分是系统重试还是用户重复提交
## 存入redis的时机
* 业务操作前插入 避免业务操作时间过长
* 如果需要考虑失败的场景 操作失败后可以重试 那需要区分用户重复请求和系统重试的场景
  * 比如分布式事务 系统重试的场景 系统重试需要支持 这样如果业务操作前插入那重试需要加隔间隔 不然重试会一直失败
  * 用户请求失败(可能超时但实际成功 也可能失败 但在用户的角度上就是失败) 用户很可能在需要请求 这时候用户需要在等一段时间